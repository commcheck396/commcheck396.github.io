---
layout: post
title: 'äº¤æµé¡¹ç›®æ€»ç»“_Bernoulli Trial'
date: 2022-1-25
author: ä¸æ˜¾ç”µæ€§
cover: 'http://commcheck396.github.io/assets/img/2022_1_25/topic.png'
tags: ML Python
---

> ### ~~æ•™æˆå¥½åƒçœŸçš„æ˜¯å¾ˆæƒ³æ•™ä¼šæˆ‘ä»¬~~

<br/>



## ä¼¯åŠªåˆ©åˆ†å¸ƒ
**ä¼¯åŠªåˆ©è¯•éªŒ**æ˜¯åªæœ‰ä¸¤ç§å¯èƒ½ç»“æœçš„**å•æ¬¡éšæœºè¯•éªŒ**ï¼Œå³å¯¹äºä¸€ä¸ªéšæœºå˜é‡Xè€Œè¨€ï¼š
- P[x = 1]=Î¼
- P[x = 0]=1-Î¼

<br/>

ä¼¯åŠªåˆ©è¯•éªŒéƒ½å¯ä»¥è¡¨è¾¾ä¸º**â€œæ˜¯æˆ–å¦â€**çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼š
- æŠ›ä¸€æ¬¡ç¡¬å¸æ˜¯æ­£é¢å‘ä¸Šå—ï¼Ÿ
- ä»Šå¤©çš„å®éªŒè¯¾è€å¸ˆä¼šç‚¹åå—ï¼Ÿ
- æ˜å¤©ä¼šä¸‹é›¨å—ï¼Ÿ

<br/>

>  If we know Âµ we can generate output that is similar to what the actual system does, this means we can predict how the system behaves.Now we want to use examples of the systems predictions training data find Âµ. So far we have onlyset the likelihood for one data-point, what about when we see lots of them? Now we will make our first assumption, we will assume that each output of the system is independent. This means that we can factorise the distribution over several trials in a simple manner


ç°åœ¨ä¸å¦¨å‡è®¾æ¯æ¬¡å®éªŒéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå½“æˆ‘ä»¬è¿›è¡Œnæ¬¡å®éªŒæ—¶ï¼Œä¾¿å¯ä»¥è·å¾—å¦‚ä¸‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç§°è¿™ä¸€ä¸²é‡å¤çš„ç‹¬ç«‹è¯•éªŒä¸º**né‡ä¼¯åŠªåˆ©è¯•éªŒ**ï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/Bern.png)

## å…ˆéªŒæ¦‚ç‡

> In order to say something about the system we need to have a prior belief about what we think the parameter Âµ is.

ä¸ºäº†è¯´æ˜ç³»ç»Ÿï¼Œæˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬ä¸ºç³»ç»ŸæŒ‡å®šä¸€ä¸ªå…ˆéªŒæ¦‚ç‡Âµã€‚
é€šä¿—çš„è®²ï¼Œå…ˆéªŒæ¦‚ç‡å°±æ˜¯**äº‹æƒ…å°šæœªå‘ç”Ÿå‰**ï¼Œæˆ‘ä»¬å¯¹è¯¥äº‹å‘ç”Ÿæ¦‚ç‡çš„ä¼°è®¡ã€‚åˆ©ç”¨è¿‡å»å†å²èµ„æ–™è®¡ç®—å¾—åˆ°çš„å…ˆéªŒæ¦‚ç‡ï¼Œç§°ä¸º**å®¢è§‚å…ˆéªŒæ¦‚ç‡**ï¼› å½“å†å²èµ„æ–™æ— ä»å–å¾—æˆ–èµ„æ–™ä¸å®Œå…¨æ—¶ï¼Œå‡­äººä»¬çš„ä¸»è§‚ç»éªŒæ¥åˆ¤æ–­è€Œå¾—åˆ°çš„å…ˆéªŒæ¦‚ç‡ï¼Œç§°ä¸º**ä¸»è§‚å…ˆéªŒæ¦‚ç‡**ã€‚ä¾‹å¦‚æˆ‘ä»¬è®¤ä¸ºæŠ›ä¸€æšç¡¬å¸å¤´å‘ä¸Šçš„æ¦‚ç‡ä¸º0.5ï¼Œè¿™å°±æ˜¯å…ˆéªŒæ¦‚ç‡ã€‚
æ‰€è°“å…ˆéªŒæ¦‚ç‡ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸»è§‚å¯¹ç³»ç»Ÿè®¾å®šçš„ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒï¼Œç°åœ¨å°±æ¥è¯´è¯´å…ˆéªŒåˆ†å¸ƒã€‚å…ˆéªŒåˆ†å¸ƒå°±æ˜¯ä½ åœ¨å–å¾—å®éªŒè§‚æµ‹å€¼ä»¥å‰å¯¹ä¸€ä¸ªå‚æ•°æ¦‚ç‡åˆ†å¸ƒçš„ä¸»è§‚åˆ¤æ–­ï¼Œä¸è®ºæ˜¯å¦æœ‰å†å²èµ„æ–™æ”¯æ’‘ï¼Œå…ˆéªŒåˆ†å¸ƒéƒ½éœ€è¦æˆ‘ä»¬ä¸»è§‚è¿›è¡Œè®¡ç®—ä¸è®¾å®šï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè´å¶æ–¯ç»Ÿè®¡å­¦ä¸€ç›´ä¸è¢«è®¤å¯çš„åŸå› ï¼Œç»Ÿè®¡å­¦æˆ–è€…æ•°å­¦éƒ½æ˜¯å®¢è§‚çš„ï¼Œæ€ä¹ˆèƒ½åŠ å…¥ä¸»è§‚å› ç´ å‘¢ï¼Ÿä½†äº‹å®è¯æ˜è¿™æ ·çš„æ•ˆæœä¼šéå¸¸å¥½ï¼
æ‹¿æ·ç¡¬å¸çš„ä¾‹å­æ¥çœ‹ï¼Œåœ¨æ‰”ä¹‹å‰ä½ ä¼šæœ‰åˆ¤æ–­æ­£é¢çš„æ¦‚ç‡æ˜¯50%ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å…ˆéªŒæ¦‚ç‡ï¼Œä½†å¦‚æœæ˜¯åœ¨æ‰“èµŒï¼Œä¸ºäº†è®©è‡ªå·±çš„æè¿°å‡†ç¡®ç‚¹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¯´æ­£é¢çš„æ¦‚ç‡ä¸º0.5çš„å¯èƒ½æ€§æœ€å¤§ï¼Œ0.45çš„å‡ ç‡å°ç‚¹ï¼Œ0.4çš„å‡ ç‡å†å°ç‚¹ï¼Œ0.1çš„å‡ ç‡å‡ ä¹æ²¡æœ‰ç­‰ç­‰ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªå…ˆéªŒæ¦‚ç‡åˆ†å¸ƒã€‚


## åéªŒæ¦‚ç‡

åéªŒæ¦‚ç‡æ˜¯æŒ‡é€šè¿‡è°ƒæŸ¥æˆ–å…¶å®ƒæ–¹å¼è·å–æ–°çš„é™„åŠ ä¿¡æ¯ï¼Œåˆ©ç”¨è´å¶æ–¯å…¬å¼å¯¹å…ˆéªŒæ¦‚ç‡è¿›è¡Œä¿®æ­£ï¼Œè€Œåå¾—åˆ°çš„æ¦‚ç‡ã€‚äº‹æƒ…å‘ç”Ÿå¯èƒ½æœ‰å¾ˆå¤šåŸå› ï¼Œåˆ¤æ–­äº‹æƒ…å‘ç”Ÿæ—¶ç”±å“ªä¸ªåŸå› å¼•èµ·çš„æ¦‚ç‡å«åéªŒæ¦‚ç‡ã€‚  
æ¯”å¦‚ä»Šå¤©ä¸Šè¯¾ä½ æ²¡æœ‰å»ï¼ŒåŸå› æœ‰ä¸¤ä¸ªï¼Œå¯èƒ½æ˜¯ç¡è¿‡äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•…æ„ç¿˜è¯¾ã€‚ä¸Šè¯¾æ—¶è€å¸ˆç‚¹åå‘ç°ä½ æ²¡æ¥ã€‚ï¼ˆè¿™é‡Œæ˜¯ä¸€ä¸ªç»“æœï¼Œå°±å°±æ˜¯ä½ æ²¡æ¥å­¦æ ¡è¿™ä»¶äº‹æƒ…å·²ç»å‘ç”Ÿäº†ï¼‰è€å¸ˆè¦è®¡ç®—ä¸€ä¸‹æ¦‚ç‡ï¼Œåˆ†åˆ«æ˜¯å› ä¸ºç”Ÿç—…äº†æ²¡æ¥å­¦æ ¡çš„æ¦‚ç‡å’Œè‡ªè¡Œè½¦åäº†æ²¡æ¥å­¦æ ¡çš„æ¦‚ç‡ã€‚  
å¾ˆæ˜¾ç„¶ï¼ŒåéªŒæ¦‚ç‡å°±æ˜¯åœ¨äº‹æƒ…å‘ç”Ÿååˆ¤æ–­ç”±å“ªä¸€ä¸ªåŸå› å¼•èµ·çš„æ¦‚ç‡ã€‚è¿™é‡Œçš„äº‹æƒ…æ˜¯ä½ æ²¡æ¥ä¸Šè¯¾ï¼ŒåŸå› æœ‰ç¡è¿‡äº†å’Œæ•…æ„ç¿˜è¯¾ã€‚  
è€Œè¿™å°±æ˜¯æˆ‘ä»¬é€šè¿‡æœºå™¨å­¦ä¹ æƒ³è¦å¾—åˆ°çš„æ•°å€¼ï¼Œé€šè¿‡åéªŒæ¦‚ç‡ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ç°å®ä¸­çš„ä¸€äº›æƒ…å†µè¿›è¡Œé¢„æµ‹ã€‚

## è´å¶æ–¯å…¬å¼
>  Once we have specified the prior we can just do Bayesâ€™ rule and get the posterior.

è¦é€šè¿‡å…ˆéªŒæ¦‚ç‡æ±‚å¾—åéªŒæ¦‚ç‡ï¼Œå¿…é¡»è¦å€ŸåŠ©è´å¶æ–¯å…¬å¼ã€‚  
è¿™ä¸€éƒ¨åˆ†æ˜¯ç®€å•çš„æ¦‚ç‡è®ºçŸ¥è¯†çš„è¿ç”¨ï¼Œä¸¾ä¸€ä¸ªæœ€å…¸å‹çš„ä¾‹å­ï¼Œä¹Ÿæ˜¯è¯¾ä¸Šçš„ä¾‹é¢˜ï¼Œå°±æ˜¯å·²çŸ¥æ£€å‡ºé˜³æ€§ï¼Œåœ¨å„ç§æ¡ä»¶æ¦‚ç‡çš„å‰æä¸‹ï¼Œæ±‚å‡ºäººç¡®å®æ‚£ç—…çš„æ¦‚ç‡ï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/qus1.png)
![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/qus2.png)
![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/qus3.png)

å¯è§ï¼Œè´å¶æ–¯æ–¹ç¨‹å¯¹äºè§£å†³è¿™ç±»é—®é¢˜ååˆ†å®ç”¨ä¸”å¿«æ·ï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/Bayes.png)


## Betaåˆ†å¸ƒ

> The second thing we will think of is that it does make sense that if I have a prior of a specific form (say a Gaussian) then I would like the posterior to be of the same form (i.e. Gaussian). So this means that we should choose a prior such that when multiplied with the likelihood it leads to a distribution that is of the same form of the prior. So why is this useful? This is very useful because it means we do not have to compute the denominator in Bayeâ€™s rule, the only thing we need to do is to multiply the prior with the likelihood and then identify the parameters that of the distribution, we can do this as we know its form.

ä½†æ˜¯æˆ‘ä»¬æ— æ³•ç¡®è®¤æˆ‘ä»¬çš„å…ˆéªŒæ¦‚ç‡æ˜¯å®Œå…¨å‡†ç¡®çš„ï¼Œ~~å¦‚æœå¯ä»¥ç¡®è®¤ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰æœºå™¨å­¦ä¹ çš„å¿…è¦äº†ï¼Œ~~æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä¸æ–­å¯¹æˆ‘ä»¬çš„æ¨¡å‹ï¼Œæ ¹æ®æ•°æ®è¿›è¡Œæ›´æ–°å’Œç»´æŠ¤ï¼Œä½†è¿™ä¸ªæ›´æ–°å’Œç»´æŠ¤çš„è®¡ç®—æ˜¯ååˆ†å¤æ‚çš„ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±è¦å°†ç›®å…‰è½¬åˆ°å…±è½­åˆ†å¸ƒï¼Œå› ä¸ºåœ¨å…±è½­åˆ†å¸ƒä¸­ï¼ŒåéªŒæ¦‚ç‡åˆ†å¸ƒå‡½æ•°ä¸å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒå‡½æ•°å…·æœ‰ç›¸åŒå½¢å¼ï¼Œè¿™æ—¶æˆ‘ä»¬ä»…éœ€è¿›è¡Œå…ˆéªŒæ¦‚ç‡ä¸ä¼¼ç„¶æ€§çš„çŸ©é˜µä¹˜æ³•ï¼Œä¾¿èƒ½å¾—åˆ°ä¸€ä¸ªç›¸åŒå½¢å¼çš„åéªŒæ¦‚ç‡ï¼Œè¿™å°±æ˜¯ä¸‹ä¸€æ¬¡è¿›è¡Œè¿ç®—çš„å…ˆéªŒæ¦‚ç‡ï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¸æ–­å‘æ¨¡å‹ä¸­æ›´æ–°æ•°æ®ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è·å¾—ä¸€ä¸ªæ„ˆåŠ å‡†ç¡®çš„æ¨¡å‹ã€‚
~~è‡³äºä»€ä¹ˆåˆ†å¸ƒæ˜¯å…±è½­åˆ†å¸ƒï¼Œç•™ç»™æ•°å­¦å®¶å§ï¼Œæˆ‘ä¸ä¼šç®—ã€‚~~

<br/>
è€Œè¿™ä¸€éƒ¨åˆ†æåˆ°çš„Betaåˆ†å¸ƒå°±æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„å…±è½­åˆ†å¸ƒï¼Œæˆ‘ä»¬é€‰æ‹©äº†è´å¡”åˆ†å¸ƒä½œä¸ºå…ˆéªŒæ¦‚ç‡ï¼Œå…¶æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ä¸ºï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/Beta.png)

é€šè¿‡ä¸€äº›~~æˆ‘éå¸¸ä¸æ“…é•¿çš„~~è®¡ç®—ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å¾—åˆ°åéªŒæ¦‚ç‡ï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/post.png)


åˆ©ç”¨Betaåˆ†å¸ƒæ¨¡å‹ï¼Œå¤§å¤§é™ä½äº†æˆ‘ä»¬ç»´æŠ¤å’Œæ›´æ–°æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦ï¼Œä¹Ÿä½¿æ¨¡å‹çš„æ›´æ–°å’Œç»´æŠ¤åœ¨æ¶ˆè´¹çº§è®¡ç®—æœºä¸Šçš„è¿è¡Œæˆä¸ºäº†å¯èƒ½ï¼Œä¸‹é¢å°±åˆ©ç”¨ä»£ç å¯¹æ¨¡å‹è¿›è¡Œä¸€äº›testã€‚  
`mu`ä¸ºæˆ‘ä»¬çœŸå®æ¦‚ç‡åˆ†å¸ƒï¼Œ`N`ä¸ºæ¨¡å‹æ›´æ–°æ¬¡æ•°ï¼Œ`a`,`b`ä¸ºæˆ‘ä»¬è®¾å®šçš„å…ˆéªŒæ¦‚ç‡ï¼Œçº¢çº¿ä¸ºæ¯æ¬¡ç»´æŠ¤æ¨¡å‹ç•™ä¸‹çš„è½¨è¿¹ï¼Œè“çº¿ä¸ºç»´æŠ¤ç»“æŸåå¾—åˆ°çš„æœ€ç»ˆæ¨¡å‹ã€‚

```python 
import numpy as np
from scipy.stats import beta
import matplotlib.pyplot as plt
def posterior(a,b,X):
    a_n = a + X.sum()
    b_n = b + (X.shape[0]-X.sum())
    return beta.pdf(mu_test,a_n,b_n)
# parameters to generate data
mu = 0.9 
N = 200
# generate some data
X = np.random.binomial(1,mu,N)
mu_test = np.linspace(0,1,100)
# now lets define our prior
a = 10
b = 10
# p(mu) = Beta(alpha,beta)
prior_mu = beta.pdf(mu_test,a,b)
# create figure
fig = plt.figure(figsize=(10,5))
ax = fig.add_subplot(111)
# plot prior
ax.plot(mu_test,prior_mu,'g')
ax.fill_between(mu_test,prior_mu,color='green',alpha=0.3)
ax.set_xlabel('$\mu$')
ax.set_ylabel('$p(\mu|\mathbf{x})$')
# lets pick a random (uniform) point from the data
# and update our assumption with this
index = np.random.permutation(X.shape[0])
for i in range(0,X.shape[0]):
    y = posterior(a,b,X[:index[i]])
    plt.plot(mu_test,y,'r',alpha=0.3)
y = posterior(a,b,X)
plt.plot(mu_test,y,'b',linewidth=4.0)
plt.show()
```

#### `mu=0.9`,`N=100`æ—¶ï¼Œå…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/100.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒä¸‹ï¼Œå³ä½¿å…ˆéªŒåˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒç›¸å·®ç”šè¿œæ—¶ï¼Œç»è¿‡100è½®çš„ç»´æŠ¤ï¼Œæœ€ç»ˆçš„æ¨¡å‹ä¹Ÿå¾ˆè´´åˆçœŸå®åˆ†å¸ƒã€‚  

<br/>

#### `mu=0.9`,`N=100`æ—¶ï¼Œå…ˆéªŒåˆ†å¸ƒéæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/100_wrong.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒä¸‹ï¼Œç”±äºçœŸå®åˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒç›¸å·®å¤ªè¿œï¼Œ100è½®çš„ç»´æŠ¤å·²ç»ä¸è¶³ä»¥è·å¾—ä¸€ä¸ªæˆ‘ä»¬æ»¡æ„çš„æ¨¡å‹ï¼Œéœ€è¦æ›´å¤šçš„æ•°æ®æ¥å¡«è¡¥å…ˆéªŒåˆ†å¸ƒçš„è¯¯å·®ã€‚


#### `mu=0.9`,`N=300`æ—¶ï¼Œå…ˆéªŒåˆ†å¸ƒéæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/300.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒä¸‹ï¼Œå³ä½¿çœŸå®åˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒç›¸å·®å¤ªè¿œï¼Œ300è½®çš„ç»´æŠ¤åæˆ‘ä»¬è·å¾—çš„æ¨¡å‹å¤§å¤§æå‡äº†ç²¾å‡†åº¦ï¼Œé€æ¸å‘çœŸå®åˆ†å¸ƒé æ‹¢ã€‚


#### `mu=0.5`,`N=50`æ—¶ï¼Œå…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š

![pic from internet](http://commcheck396.github.io/assets/img/2022_1_25/50.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒä¸‹ï¼ŒçœŸå®åˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒç›¸åŒæ—¶ï¼Œåœ¨50è½®çš„è®­ç»ƒä¸­ï¼Œè™½ç„¶åœ¨è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€äº›åç§»ï¼Œä½†äº”åè½®ä¹‹åçš„ç»“æœè¿˜æ˜¯ååˆ†å‡†ç¡®çš„ã€‚

##### å˜¿å˜¿ï¼Œå°±å†™è¿™ä¹ˆå¤šï¼Œèµ°ä¹ğŸ¥±ã€‚